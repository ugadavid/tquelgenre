<!DOCTYPE html>
<html lang="fr">
    <head> 
        <title> TQuelGenre - Tableau de bord </title>
        <meta charset="utf-8">
        <link href="styleboard_ok.css" rel="stylesheet">
        <link href="scores.css" rel="stylesheet">
        <script src="debug.js" defer></script>
        <script src="user.js" defer></script>
        <script src="modal.js" defer></script>
        <script src="search.js" defer></script>
    </head>

    <body>
        <header>
            <div id="tdb_header1_all">
                <div class="tdb_header1">
                    <a href="index.html"> <img src="ressources/logo.png" alt="Logo TQG" title="Logo" class="tdb_logo"> </a>
                    <div>
                        <a href="javascript:void(0);" onclick="openModal('popup_profile.html')">Mon profil</a>
                        <a href="javascript:void(0);" onclick="resetUser()"> DÃ©connexion </a>
                    </div>
                </div>
            </div>

            <div id="tdb_header_anderson_all">
                <div id="tdb_header_anderson">
                    <div class="tdb_header2">
                        <nav>
                            <a href="tableau_de_bord.html"> ğŸ“ŠTableau de bord </a>
                            <a href="categorie.html"> ğŸ§®CatÃ©gories </a>
                            <a href="jeux.html"> ğŸ•¹ï¸Jeux </a>
                            <a href="regles.html"> ğŸ“šRessources </a>
                        </nav>

                        <div class="tdb_header2-B">
                            <form id="search_form" action="recherche.html">
                                <div class="tdb_chercheur-container">
                                    <input name="search" type="text" id="tdb_chercheur" placeholder=" ğŸ” Rechercher...">
                                </div>
                            </form>
                            <h1> Bienvenue sur ton tableau de bord ! </h1>
                        </div>
                    </div>

                    <div id="tdb_container_avatar"> 
                        <img src="ressources/avatars_edit/woman_7.png" alt="Avatar apprenant" title="avatar">
                    </div>
                </div>
            </div>
        </header>




        <main>
            <section class="tdb_section_scores">
                <p>Bienvenue sur ton tableau de bord ! ğŸ®

                    Ici, c'est ton espace personnel pour suivre tes progrÃ¨s, dÃ©velopper ton avatar et devenir le maÃ®tre 
                    des genres grammaticaux ! ğŸ‰<br/>
                    
                    En haut, tu vois ton personnage : un reflet de ton parcours. Chaque mot que tu maÃ®trises le rend plus 
                    puissant. Plus tu avances, plus ton avatar Ã©volue, et Ã  chaque Ã©tape, tu dÃ©bloques de nouvelles 
                    transformations impressionnantes. ğŸš€<br/>
                    
                    Alors, prÃªt Ã  faire grandir ton hÃ©ros ? DÃ©couvre toutes ses transformations et atteins son niveau maximal !  ğŸ’¥<br/>
                    
                    Dans cette aventure, tu vas aussi pouvoir suivre tes scores, admirer tes badges et, bien sÃ»r, affronter 
                    tes "ennemis jurÃ©s" (ces mots qui te rÃ©sistent encore !). Tout est conÃ§u pour t'aider Ã  progresser et Ã  atteindre des sommets. ğŸ”¥<br/>
                    
                    N'oublie pas de consulter les astuces personnalisÃ©es pour propulser ton apprentissage et exploser tes records ! ğŸ˜<br/>
                    
                    PrÃªt pour un nouveau dÃ©fi ? C'est parti ! </p>

                <h2> Scores </h2>

                <div class="tdb_graphique_scores">
                    <div class="container-score">
                        <div class="legend">
                            <div><span class="low"></span>A retravailler</div>
                            <div><span class="medium"></span>Moyenne</div>
                            <div><span class="high"></span>MaÃ®trise</div>
                        </div>
                        <div class="bars-wrapper">
                            <div class="bar-container"><div class="label">La famille</div>
                            <div class="bar"><div class="section" style="width: 60%;"></div></div></div>
                            <div class="bar-container"><div class="label">L'amour</div>
                            <div class="bar"><div class="section" style="width: 60%;"></div></div></div>
                            <div class="bar-container"><div class="label">Le corps</div>
                            <div class="bar"><div class="section" style="width: 60%;"></div></div></div>
                            <div class="bar-container"><div class="label">La santÃ©</div>
                            <div class="bar"><div class="section" style="width: 60%;"></div></div></div>
                            <div class="bar-container"><div class="label">Les vÃªtements</div>
                            <div class="bar"><div class="section" style="width: 10%;"></div></div></div>
                            <div class="bar-container"><div class="label">la cuisine</div>
                            <div class="bar"><div class="section" style="width: 40%;"></div></div></div>
                            <div class="bar-container"><div class="label">La mÃ©tÃ©o</div>
                            <div class="bar"><div class="section" style="width: 100%;"></div></div></div>
                            <div class="bar-container"><div class="label">Le tourisme</div>
                            <div class="bar"><div class="section" style="width: 70%;"></div></div></div>
                        </div>
                        <div class="pourcent">
                          
                          <div>0</div>
                          <div>20</div>
                          <div>40</div>
                          <div>60</div>
                          <div>80</div>
                          <div>100</div>
                      </div>
                    </div>
                </div>
            </section>



            <section class="tdb_section_badges">
                <h2> Tes badges obtenus ! </h2>
                <div class="tdb_badges_container1">     
                    <div>
                        <img src="image/badges/debutant_curieux_on.png" alt="Badge 'name'" title="Badge 1">
                        <h3> DÃ©butant curieux </h3>
                        <p> Tu as complÃ©tÃ© ta premiÃ¨re catÃ©gorie. </p>
                    </div>

                    <div>
                        <img src="image/badges/flash_learner_on.png" alt="Badge 'name'" title="Badge 2">
                        <h3> Flash learner </h3>
                        <p> Tu as rapidement terminÃ© un jeu. </p>
                    </div>

                    <div>
                        <img src="image/badges/streak_jour_2_off.png" alt="Badge 'name'" title="Badge 3">
                        <h3> Streak +2 </h3>
                        <p> DÃ©bloquÃ© si tu joues pendant deux jours consÃ©cutifs. </p>
                    </div>

                    <div>
                        <img src="image/badges/tetu_mais_vainqueur_off.png" alt="Badge 'name'" title="Badge 4">
                        <h3> TÃªtu mais vanqueur </h3>
                        <p> DÃ©bloquÃ© une fois battus cinq de tes ennemis jurÃ©s. </p>
                    </div>
                </div>

                <div class="tdb_badges_container2">
                    <div>
                        <img src="image/badges/streak_jour_7_off.png" alt="Badge 'name'" title="Badge 5">
                        <h3> Streak +7 </h3>
                        <p> DÃ©bloquÃ© si tu joues pendant sept jours consÃ©cutifs. </p>
                    </div>

                    <div>
                        <img src="image/badges/expert_du-genre_on.png" alt="Badge 'name'" title="Badge 6">
                        <h3> Expert du genre - A1 </h3>
                        <p> Tu as terminÃ© toutes les catÃ©gories du niveau A1 et corrigÃ© toutes tes erreurs.  </p>
                    </div>

                    <div>
                        <img src="image/badges/streak_jour_14_off.png" alt="Badge 'name'" title="Badge 7">
                        <h3> Streak +14 </h3>
                        <p> DÃ©bloquÃ© si tu joues pendant 14 jours consÃ©cutifs. </p>
                    </div>
                </div>
            </section>



            <section class="tdb_section_erreurs">
                <h2> Tes ennemis jurÃ©s </h2>
                <p>Voici le top 5 des mots qui te rÃ©sistent le plus, ceux avec lesquels tu as des difficultÃ©s. ğŸ¤º</br></p>
                <div class="tdb_erreurs_container">
                    
                </div>
            </section>



            <section class="tdb_section_astuces">
                <h2> Astuce pour progresser </h2>

                <div>
                    <p id="tdb_astuces_texte"> 
                        
                        ğŸ§  Pour progresser efficacement, nous te conseillons de suivre l'ordre des catÃ©gories qui a Ã©tÃ© pensÃ© pour un apprentissage progressif :<br/><br/>

1. La famille<br/>
2. L'amour<br/>
3. Le corps<br/>
4. La santÃ©<br/>
5. Les vÃªtements<br/>
6. La cuisine<br/>
7. La mÃ©tÃ©o<br/>
8. Le tourisme<br/><br/>
Chaque catÃ©gorie te permet d'approfondir progressivement ton vocabulaire 
tout en t'appuyant sur les acquis prÃ©cÃ©dents. Bonne exploration ! ğŸš€
                    </p>

                    <img src="ressources/declic.png" alt="Image dÃ©clic" title="IdÃ©e pour vous" id="tdb_astuces_img_declic">
                </div>
            </section>



            <section class="tdb_section_jouer">
                <div id="tdb_all_botons">
                    <div class="tdb_container_boutons">
                        <a href="" class="bouton"> Continuer progrÃ¨s  </a>
                        <img src="ressources/icones_bouton/continuer.png" alt="Bouton pour continuer" title="Continuer">
                    </div>
                
                    <div class="tdb_container_boutons">
                        <a href="" class="bouton"> Choisir catÃ©gorie </a>
                        <img src="ressources/icones_bouton/choisir.png" alt="Bouton pour choisir catÃ©gorie" title="Choisir">
                    </div>
                    
                    <div class="tdb_container_boutons">
                        <a href=""  class="bouton"> RedÃ©marrer </a>
                        <img src="ressources/icones_bouton/redemarrer.png" id="tdb_image_redemarrer" alt="Bouton pour redÃ©marrer" title="RedÃ©marrer">
                    </div>
                </div>
            </section>
        </main>

        



        <footer>
            <div id="footer_all">
                <a href="mentions_legales.html" class="footer_page1"> Mentions lÃ©gales </a>
                <a href="contacts.html" class="footer_page2"> Contacts </a>
                <a href="plan_du_site.html" class="footer_page3"> Plan du site </a>
                <a href="credits_et_sources.html" class="footer_page4"> CrÃ©dits et sources </a>
            </div>
        </footer>



        <script>
            window.addEventListener('DOMContentLoaded', function() {                
                showUser();            // Affiche l'utilisateur dans la fenÃªtre de debug
                checkConnection();     // VÃ©rifie si l'utilisateur est connectÃ©


                let zuser = getUser();
                
                const scoreCount = getZeroScoresCount();  // RÃ©cupÃ¨re le nombre de '0|0|0'
                const avatarImg = document.querySelector('#tdb_container_avatar img');  // SÃ©lectionne l'image de l'avatar

                // ğŸ›  DÃ©termine le numÃ©ro d'avatar selon le score
                const avatarIndex = Math.min(scoreCount, 5);  // Limite l'index max Ã  5
                avatarImg.src = `ressources/avatars_edit/woman_${avatarIndex}.png`;  // ConcatÃ¨ne dynamiquement

                // ğŸ›  Exemple d'utilisation :
                const enemArray = getEnemArray();
                console.log(enemArray);
                


                
                const enemContainer = document.querySelector('.tdb_erreurs_container');  // SÃ©lectionne le conteneur vide

                // Vider le conteneur au cas oÃ¹
                enemContainer.innerHTML = '';

                // ğŸ›  Remplir le conteneur dynamiquement
                enemArray.forEach((enem, index) => {
                    const enemDiv = document.createElement('div');  // CrÃ©e un <div> pour chaque ennemi
                    const img = document.createElement('img');      // CrÃ©e l'image
                    const p = document.createElement('p');          // CrÃ©e le <p> pour le nom

                    // ğŸ›  Configurer l'image dynamiquement
                    img.src = `ressources/ennemies/evil_${index + 1}.png`;  // Images nommÃ©es evil_1.png, evil_2.png, ...
                    img.alt = `Image 'personnage ${index + 1}'`;
                    img.title = `Personnage ${index + 1}`;

                    // ğŸ›  Configurer le texte
                    p.textContent = enem;
                    p.className = 'tdb_ej_masculin';

                    // ğŸ›  Ajouter l'image et le <p> dans le <div>
                    enemDiv.appendChild(img);
                    enemDiv.appendChild(p);

                    // ğŸ›  Ajouter le <div> dans le conteneur
                    enemContainer.appendChild(enemDiv);
                });

                // ğŸ›  Mettre Ã  jour le texte du <p> d'intro avec le nombre d'ennemis
                const introParagraph = document.querySelector('.tdb_section_erreurs p');
                introParagraph.innerHTML = `Voici le top ${enemArray.length} des mots qui te rÃ©sistent le plus, ceux avec lesquels tu as des difficultÃ©s. ğŸ¤º</br>`;



                
                



                //  Srcs
                const scrArray = getScrArray();  // RÃ©cupÃ¨re tous les scrs dans un tableau
                const bars = document.querySelectorAll('.bar .section');  // SÃ©lectionne toutes les sections des barres
                const totalWords = [45, 31, 28, 29, 52, 80, 12, 47];
                let y = 0;

                // ğŸ›  Parcourt chaque score et chaque barre
                scrArray.forEach((scr, index) => {
                    if (bars[index]) {  // VÃ©rifie qu'il y a bien une barre correspondante
                        const percentage = getScorePercentage(scr);  // Calcule le pourcentage pour chaque scr
                        bars[index].style.width = `${percentage}%`;  // Met Ã  jour la largeur de la barre
                        bars[index].classList.add(getScoreMasterClass(scr, totalWords[y]));
                    }
                    //console.log(`yop:  ${getScoreErrorsAverage(scr)}`);
                    //console.log(`yip: ${getScoreMasterClass(scr, totalWords[y])}`);
                    y++;
                });




                //  Badges
                //console.log(getBadges());
                const badges = document.querySelectorAll('.tdb_badges_container1 img, .tdb_badges_container2 img');  // SÃ©lectionne toutes les images de badges
                const bitfield = getBadges();

                badges.forEach((badge, index) => {
                    const badgeBit = 1 << index;  // Calcule la valeur du bit pour ce badge (2^index)
                    
                    if ((bitfield & badgeBit) !== 0) {  // VÃ©rifie si le bit est activÃ©
                        badge.src = badge.src.replace('_off', '_on');  // Active le badge
                    } else {
                        badge.src = badge.src.replace('_on', '_off');  // DÃ©sactive le badge
                    }
                });

                
                            
            });
        </script>
    </body>
</html>